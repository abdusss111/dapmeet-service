from db import SessionLocal
from models import Meeting
from sqlalchemy.orm import Session
from datetime import datetime

# Настройка
meeting_id = "837c454a-9613-49e1-90ec-799b7cdb85c8"
user_id = "107269937002782393048"
transcript_text = """
00:00 Salta Bolatova: сегодня отметим и завтра улетаем в Астану Ну мы пока базируемся в Астане у нас сегодня день рождения квест еще вот
00:05 Jaslan Aldongarov: И там живете там. новый офис В этом как в колесах. Так давай я тебе вкратце, как ты, видишь еще, чтобы обновить задачу, Что Бог должен делать в твоем случае?
00:34 Salta Bolatova: Вот, смотри, вот по идее, Да вот моего администратора очень много времени уходит на вот это вот подтверждение команд. Различные она постоянно отвечает на один не те же вопросы там, типа знаешь, пожалуйста, зарегистрируйте нас хоть мы там всех просим. Да там у нас есть приложение даже вот вы всех игроков просим, чтобы они сами регистрировались через сайт. Нет один приходит с этим запросом, короче, ну ручками, типа сами зарегистрируйте, нас это бесит, короче.
01:08 Salta Bolatova: И вот И реально мне нужен один человек, который будет сидеть чисто на телефоне.
01:14 Jaslan Aldongarov: А сколько у тебя обращение вообще в день или там в период какой-то?
01:18 Salta Bolatova: Ты знаешь, иногда, бывает столько сообщений. Вот прям, Ну может быть сообщение, 20 до От разных людей, А бывает вообще Глухо Ну не подгадаешь, особенно, когда такие какие-то тематические игры прикольные у всех вопросы сразу. А это будет там тематика по книгам, А это будет по фильмам. А это что, А это как? Ну и так далее.
01:43 Jaslan Aldongarov: То есть какой-то контент, который динамический. Да он меняется там раз в неделю, это одна тематика, во втором деле, это другая тематика и так далее.
01:52 Salta Bolatova: Да у нас получается мы играем со вторника по воскресенье и допустим, есть определенные дни, когда классические игры они такие, Ну знаешь спокойные там есть свои игроки, все знают все привыкли. А вот иногда есть такие игры для новичков, например, вот там начинается. Треш там сразу начинается вот эти новые команды совсем, который незнакомы с призом, например, они 100 500 вопросов начинают задавать. Ну это ладно, как бы здесь проблем, не вижу здесь. Ну, админ, может даже со своей личке, допустим отвечать.
02:25 Salta Bolatova: Рабочего она отвечает и все. Вот самое главное это вот подтверждение команд. Например, вот сегодня у нас 47 команда будет на игре. Это порядка в 275. Ну ладно, это в людях суммарно не будем считать вот 47 команд. На подтверждение. У нее ушло три часа.
02:46 Jaslan Aldongarov: Если это надо самой написать и подтвердится.
02:48 Salta Bolatova: Она отправляет рассылку получает она вот, ну, скачивает список с нашей админки. Заходит копирует заходит в WhatsApp вставляет, если было с ним переписка, она ему пишет, если не было переписки, она его сохраняет там все дела, короче.
03:06 Jaslan Aldongarov: Нужно еще сервис рассылки какой-то.
03:08 Salta Bolatova: Да, да, подтверждение. Типа привет. Ты Вчера зарегистрировался, например, на игру подтверждаем твое участие, там игра состоится там-то Во столько-то мы тебя ждем. Напиши точное количество людей, чтобы посадка была, ну, типа нормальной. И все И мы ждем ответа, когда они начинают отвечать. Там, типа нас будет 6 или там, мы удаляемся. Мы не сможем. А вот нас будет больше. Короче мы начинаем это подтверждение делать У нас в админке. Я тебе сейчас могу. Или Я тебе отправляла уже нашу админку.
03:40 Jaslan Aldongarov: По-моему, скриншот.
03:42 Salta Bolatova: Да скриншот, вот, типа, она вот так выглядит, короче, там. Все указано email, там телефон и так далее так далее. Вот, короче, вот больше меня раздражает то, что мы тратим очень много времени на подтверждение.
03:59 Jaslan Aldongarov: А это капитаны или это все участники команд?
04:02 Salta Bolatova: Это капитаны это вот тот кто регистрирует.
04:05 Jaslan Aldongarov: То есть условно за раз, может быть, там максимум 50 рассылок, да? Вы придете неприятие?
04:10 Salta Bolatova: Да например, как сегодня до 47 команд, например, и вот 47 сообщений 47 рассылок Или например, Мы играем в среду и четверг в двух барах. Ну и там, Соответственно по 30 команд это 60 получается.
04:30 Jaslan Aldongarov: Вот у нас либо первое сообщение от нас, либо нам написали. Вот сюда. Какие вопросы Мы отрабатываем.
04:43 Salta Bolatova: Да, да.
04:45 Jaslan Aldongarov: вопросы
04:49 Salta Bolatova: Ну, там, типа, знаешь, концу ведь к концу вечера, например, перед игрой они там пишут. Ой там Мы там слились.
04:58 Jaslan Aldongarov: Участие тоже, наверное, какие-то условия до от адрес типа и такое информативно.
05:05 Salta Bolatova: Такого Куда приехать или там вы знаете, у нас дни рождения сегодня у игрока, типа, можете его поздравить. А можно мы тортик привезем в бар? знаешь или
05:16 Jaslan Aldongarov: информация Еще какого рода рубрика вопросов может быть, Вот есть опрос участие, либо слив, Понятно есть информация, типа, когда во сколько где? Еще есть какие-то рубрики.
05:31 Salta Bolatova: Ну вот по играм, Да там спрашивают, тематика такая-то это будет по фильмам или что? Это тоже информация относится больше, да?
05:40 Jaslan Aldongarov: Ну да, это больше конфетти, Что за игра, где будет находиться? На какую тему? локации И какие-то другие вопросы типа, Можно ли с собой тортик, Там и так далее.
06:08 Salta Bolatova: Да, А типа дети бесплатно ли там типа, А если
06:10 Jaslan Aldongarov: а пруф участие
06:13 Salta Bolatova: я ребенка приведу там, типа знаешь?
06:16 Jaslan Aldongarov: Какие-то правила, да?
06:18 Salta Bolatova: да
06:20 Jaslan Aldongarov: Правила там и вообще другие вопросы. Примерно вот так, а проф участие, если я прогнута тебе нужно это куда-то в таблицу складывать, да?
06:34 Salta Bolatova: да
06:35 Jaslan Aldongarov: Или слились тоже, да? Так вот здесь у нас просто идет вопрос ответ. Без какого-то функционала правильно просто там консультируем. службы поддержки
07:07 Salta Bolatova: Там знаешь, какие вопросы бывают, типа по корпоративным? Да ну, допустим, колеса написали, она делает крышу, кстати, в этот ивент. Я на этом пишет можете провести нам игру для корпус корпус Для компании таких тоже бывает.
07:28 Jaslan Aldongarov: Скорб заказов, чем нужно просто тебе в телегу уведомить?
07:33 Salta Bolatova: Корпус заказа, Короче я их сама обрабатываю сама лично, потому что я как продажник и веду контролирую все это, поэтому мой администратор, говорит заказам, пожалуйста, обращайтесь сюда, либо она говорит, я передам ваш номер телефона с вами свяжутся. Я начинаю переписку.
07:50 Jaslan Aldongarov: Перевести на тебя.
07:52 Salta Bolatova: Там чисто знаешь такая.
07:59 Jaslan Aldongarov: Так еще какие-то вопросы участие. Типа хочу к вам на работу устроиться Или там или они не существенно?
08:13 Salta Bolatova: Это в основном пишут. Нет, вот чисто рабочий телефон таким вопросом корпоративный заказ заявки, потом обрув получается И вот такие всякие тупые вопросы.
08:27 Jaslan Aldongarov: Короче, по карте понятно, Давайте покажу, что они умеют. Быстро пробегусь. Так вот номер где можно моего Бота потестить он там рассказывает, какие услуги Мы представляем Сколько стоит если чингизу будешь скидывать мог что-то нажать посмотреть, как все работает клиенты, Либо мы можем написать WhatsApp Instagram Telegram сайте. Это каналы взаимодействия с клиентами, но и что первое писать не умеет. У тебя есть подтверждение участия. Мы с помощью какого-то сервиса рассылки должны написать.
09:02 Jaslan Aldongarov: Первое сообщение есть. Вот такие вот сервисы стоит 5000 тенге в месяц отсюда можно сделать рассылки. все максимально просто У меня стоит на моем бате рассылка.
09:42 Salta Bolatova: 707 775 61
09:48 Jaslan Aldongarov: Списком просто сюда вставляешь кучу номеров. Куда тебе нужно рассылку? И пишет сообщение.
09:59 Salta Bolatova: TA например
10:13 Jaslan Aldongarov: А, кстати, заранее рассылку.
10:30 Salta Bolatova: Да пришло
10:33 Jaslan Aldongarov: Что-то ответишь сейчас? какие-то изменения
11:08 Salta Bolatova: Это тоже. Да, мы получается, это пишем, да?
11:12 Jaslan Aldongarov: Нет, Вот это уже робот робот тебе написал. Мы просто инструкции даем теперь что как делать?
11:17 Salta Bolatova: Ага
11:18 Jaslan Aldongarov: Когда мы хотим подтвердить участие, типа робота есть инструкция, что ты должен, если тебе говорят Да подтверждаю. Он там фиксирует, типа номер телефона капитана и подтвердил участие, да в таблицу. Примерно так можно фиксировать у меня таблица по другому работает. У меня, когда клиенты обращаются, Я по ним записываю всю дату есть имя телефона, о, чем робот с ним поговорил. Я записываю нужное мне штуки. Да можно вариативно это поменять на что-то другое, Не сама ли диалога, например, подтвердил участие. Да? Нет, не Первое сообщение клиента, если есть какие-то изменения таблицы будешь видеть.
12:12 Salta Bolatova: Ага
12:15 Jaslan Aldongarov: Так вернуться вернуться. Вернуться к фрезе, короче, клиенты нам написали в один из каналов. Или мы им написали через рассылку. Там ещё как-то дальше все обрабатывать gpt и роли инструкции, которые мы задали. Потом все это можно выводить в crm-ку. Если Битрикс ама есть, можно в Telegram ляжки уведомлять, например, когда корпоративный заказ пришел тебе в личку будет падать там робот пообщался, типа, там корм заказ просят. Можешь подключиться именно к этому чату.
12:48 Jaslan Aldongarov: Либо настроить роботу инструкцию, чтобы он твой номер давал обратиться. здесь функционал робота любой язык мира Казанский русский испанский турецкий какой Параллельно работала голосовые он понимает на русском идеально на казахском 50 окончание сглатываем. Можем через 10 минут, пока мы до успешного сценарий написали. Подтвердите свое участие. Он такой да, Сейчас отвечу и замолчал на 2 на
13:32 Salta Bolatova: и уже
13:33 Jaslan Aldongarov: 2-3 часа. Мы можем поставить там контрольную отложку Через два часа, типа, Можете пожалуйста нам ответить и и возвращать клиентов диалог. Вот так уведомляшками в телеге. Например, тот же самый корм заказ. Ты будешь получать имя номер телефона резюме переписки еще что захочешь.
13:56 Salta Bolatova: Отлично вот это.
13:59 Jaslan Aldongarov: Здесь мы сделали, по оптом робот, получается принимает заказы на установку запрашивает размер и берет согласие на звонок. Если клиент согласен, то мы заказчику отправляем новую клиента. Вот такого. Табличку эти показывал у тебя нету, да?
14:19 Salta Bolatova: Нет.
14:21 Jaslan Aldongarov: Если в живую показывает Так выглядит. новая заявка, если замолчишь, просто, Если согласишься Это больше для продаж.
14:51 Salta Bolatova: Да это нужно нам не надо.
14:54 Jaslan Aldongarov: Календарь тоже, наверное, не надо. Но если чем можно, например, корм заказы, чтобы робот тебе встречки назначал, типа хотите встретиться, Я организую встречу Салтана и он твой календарь чекает свободно и может заполнять. Ну скорее всего, это не надо. Это лишний шаг. Там просто Согласие типа созвониться и уведомления тебе хватает. Так ношен таблицы. Вот у меня появился даже динамический контент есть основная инструкция, типа, Кто мы такие, как мы работаем. Там, как проходит игры и так далее какие-то общие правила, можно с собой что-то взять нельзя, а есть динамический контент, который у тебя из каждого криза разный и тебе можно сделать табличку, где у тебя будет название виза, дата его проведения место проведения. То есть все параметры, которые меняются ты можешь просто с этой табличкой работать туда добавлять новые знания для Бота и он всегда с этой табличке будет ориентироваться у него спрашивают по игре Гарри Поттер спрашивает, какую дату 10 марта пошел проверил 10 марта и посмотрел, какие у него условия либо информация. Ты
16:11 Salta Bolatova: OK
16:14 Jaslan Aldongarov: можешь без моего участия. Но не через Google Короче мне только. Так, Ну тут кейсы, которые я делал. Интересно, что-то вряд ли больше, когда продаю, короче, здесь показываю. По цене робот болталка, Короче у тебя средний пакет из тех функций, которые тебе нужны и я тебе минусану 50 тысяч тенге, потому что у меня примерно столько стоит привлечение клиентов. Ты мой знакомый тебе хочется сделать скидку плюс. Я на тебя не потратил на рекламу ничего вот эту разницу станет.
16:59 Jaslan Aldongarov: По деньгам хвостик идет на создание кабинета. Ну чтобы, короче пользоваться чатом оплачиваешь его, и вот сумма в 30 тысяч тенге. Она остается у тебя ежемесячной по поводу техподдержки, сделаю Бота Так что она тебе не потребуется. А если какие-то мелочи корректировки, нужно вправить исправить. в принципе
17:33 Salta Bolatova: Короче, ежемесячно, я Оплачиваю 30 тысяч тенге, правильно? а один пакет будет стоить получается 300 300 до
17:44 Jaslan Aldongarov: 330 минус 50 280 из этих 280 я 30 тысяч не уже трачу на первый месяц подписки.
17:51 Salta Bolatova: Так, а Премиум Премиум же я же, если вот, типа буду.
17:56 Jaslan Aldongarov: если у тебя сердце Если какая-то интеграция через API либо CRM подключение, это все работа сапе, она сложнее, мне надо разработать. Но можешь потом там не знаю доплатить разницу в пакете и какую-то систему подрубить, если надо.
18:14 Salta Bolatova: Слушай Жаса смотри, А если я сейчас предложу, допустим, в Москве да, вот у нас же они сидят там головные, если я предложу эту тему Москве и скажу. Дайте мне, пожалуйста, как его, Господи
18:29 Jaslan Aldongarov: бюджет
18:30 Salta Bolatova: Не бюджет. Дайте мне разрешение. Чтобы короче, Твои разработчики залезли в нашу эту штуку разработку в админку. Смотри когда получается вот вот, допустим, вот сейчас расскажу всем рассылку сделал, да, ей все ответили. Мы же потом получается, это подтверждение заносим сюда в админку в нашу. В общую получается сейчас как Блин я вообще деградирую, если честно. Давайте покажу свой экран. и на примере, может быть, мы сможем продать эту идею в Москве И они скажут, Давай типа на всех сделаем. Вот например, да.
19:32 Salta Bolatova: На всех забабахаем и все города получаются у тебя Купит все это. Вот. Смотри, вот так выглядит наша админка. Сейчас где она у меня?
19:42 Jaslan Aldongarov: Так называется.
19:47 Salta Bolatova: Я тебе не скажу. Получается, вот вообще квест сайт и у каждого, короче города У каждого франчайзи есть своя админка, где вот мы наблюдаем, где Мы открываем игры, Например где мы регистрируем команду, если сами регистрируем, Вот так это все выглядит тебе видно, да?
20:10 Jaslan Aldongarov: да
20:12 Salta Bolatova: Вот и вот, когда допустим, вот сегодня. Да например, день рождения сегодня. Вот игра получается и здесь админ. После того как она всем рассылку сделала. И вот ей все подтвердили по какое количество это человек придет в той или иной команде, она здесь ручками подтверждает. Вот зеленые. Это, типа уже подтвержденные команды. Видишь? А есть вот такие вот такая графа, типа команды в резерве это Это типа те, кто еще не может попасть на игру, Потому что мест нету, но вдруг, если кто-то сольется, мы их Обязательно позовем.
20:49 Salta Bolatova: Типа такого и вот здесь она потом отсюда вот таким образом, типа удалить или перенести в подтвержденные она тоже ручками это все делает. вот поэтому
21:05 Jaslan Aldongarov: я понял, короче, завязать общение Бота с
21:11 Salta Bolatova: Да если вдруг Москва разрешит залезть нашу в нашу админку через наших разрабов и через твоих, чтобы допустим, вот бот, например, подтвердил. Да ну человек живой и сказал, там, типа нас пять человек будет Вот такой Окей зафиксировал у себя и тут же в админке ее их подтвердил и изменил количество людей. Например если изменилось количество людей такое возможно.
21:36 Jaslan Aldongarov: Теоретически Это возможно, но, по-моему, это
21:36 Salta Bolatova: Не всегда, то есть, получается мы когда
21:39 Jaslan Aldongarov: муторно, там нужно идентифицировать человека. Как-то по номеру телефона я так понимаю, номер телефона совпадает.
21:49 Salta Bolatova: делаем рассылку.
21:53 Jaslan Aldongarov: А мы в рассылке можем указывать данные вот
21:53 Salta Bolatova: иногда
21:55 Jaslan Aldongarov: эти вот джанара ваш типологин или емейл, вот по имейлу можно идентифицироваться.
22:03 Salta Bolatova: Но email. Да они же всегда пишут свои настоящие мейлы, Потому что им приходят подтверждение, когда они регистрируются, они приходят подтверждение, типа ты зарегистрировался на игру такого-то числа такого-то в таком-то баре. Мы тебе за день позвоним и еще узнаем, типа, придешь ты или нет.
22:23 Jaslan Aldongarov: Теоретически это возможно по времени по
22:25 Salta Bolatova: Но сложно, да.
22:26 Jaslan Aldongarov: времени по ресурсам выглядит сложно и пока я не понимаю. Вот сколько это времени может занять. Если оставить на ручками менеджер, просто с таблицы все общение на себя будут забирает только запускает рассылки, либо ручками, потом через время в табличку идет и смотрит, Кто там ответил, кто не ответил сделать можно прямо сейчас.
22:56 Salta Bolatova: Но Окей хорошо. Ну а так, в принципе, можно будущему, короче, сейчас переехали в жиру наши сейчас разрабы переезжают получается.
23:06 Jaslan Aldongarov: В жире открыто описывались как минимум.
23:08 Salta Bolatova: Да он в Москве свои разрабы вот эту всю штуку они делают, и мы сейчас переехали в жиру, Может быть, там будет Немного полегче. Если вдруг какая-то штука будет интересно, ну, посмотрим. Окей поняла ты мне презенташку скинешь? Мне надо будет с партнерами говорить. Я как раз
23:29 Jaslan Aldongarov: да
23:32 Salta Bolatova: сегодня вечером на ДР и я им расскажу.
23:36 Jaslan Aldongarov: Без проблем, и я тебе скину резюме все наши встречи.
23:44 Salta Bolatova: Ага
23:46 Jaslan Aldongarov: У вас из-за ваших рассылок ручных никогда
23:49 Salta Bolatova: Смотри раз получается, нам же не нужно покупать отдельный какой-то номер телефона. Мы же все привязано наш номер телефона правильно наш рабочий.
23:59 Jaslan Aldongarov: его не блоками.
24:01 Salta Bolatova: Нет.
24:03 Jaslan Aldongarov: Когда можно на рабочий, Но если ты хочешь, Прям вообще без рисков можно купить новую симку?
24:10 Salta Bolatova: Просто этот телефон уже очень Многие знают, он уже шесть лет существует и везде везде, и он прям везде. Не хотелось бы от него.
24:19 Jaslan Aldongarov: Ну короче, из-за из-за самого Бота блокировок быть не может, потому что Представь что это в WhatsApp на компьютере, за которым Человек сидит тот же самый принцип, у него через связано устройство работать, но вот создает быструю большую активность, чтобы вызывает подозрение уметой и у меня из 30 ребят, кого я делал кейсов один был, которого заблочили, у него там день 350 клиентов было.
24:49 Salta Bolatova: А Ну нет, ну, у нас получается. Вот каждый день игра, если мы каждый день подтверждаем, но это где-то мы 30 30 грубо 40 человек Отправляем рассылку.
25:05 Jaslan Aldongarov: Потому что у меня на личном номер сентября живет и ни разу ничего не происходило. У меня деньги 30 40 обращений.
25:21 Salta Bolatova: ну
25:21 Jaslan Aldongarov: Я думаю, единственное, что я боюсь, потому что когда ты исходящие пишешь здесь.
25:40 Salta Bolatova: А блокируют надолго или там, типа можно дальше что-то сделать?
25:45 Jaslan Aldongarov: Ну вот ребят заблочили, Они через неделю восстановили аккаунт.
25:49 Salta Bolatova: Ну переживем, Я думаю
25:53 Jaslan Aldongarov: Короче короче гарантировать, что тебя не заблочат из-за исходящих рассылок. Я не могу, если открыто говорить. Из-за самого робота то, что мы его подключим, он будет общаться. Вот нету такого, Что что-то запрещено, он всегда разные сообщения пишет. Он не использует там шаблоны. Вот из-за того, что ты у тебя исходящий трафик, А это является спамом, по мнению Ватсапа здесь я не могу вот эти риски.
26:24 Salta Bolatova: Ну ладно, посмотрим.
26:27 Jaslan Aldongarov: Все тогда с меня сестрички прежде я тебе скинул и примерно мне сама выйдешь на связь
26:32 Salta Bolatova: да
26:34 Jaslan Aldongarov: продажник.
26:34 Salta Bolatova: Да я буду ладно.
  
"""

# Подключение к БД
db: Session = SessionLocal()

# Найти встречу
meeting = db.query(Meeting).filter(Meeting.id == meeting_id, Meeting.user_id == user_id).first()
if not meeting:
    raise Exception("Meeting not found or does not belong to the user.")

# Обновить транскрипт
meeting.transcript = transcript_text.strip()

# Сохранить
db.commit()
print("✅ Transcript updated for meeting", meeting_id)
